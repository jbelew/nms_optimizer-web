/* Tailwind base, theme, and utilities layers */
@layer base {
	@import "tailwindcss/preflight.css";
}

@layer theme {
	@import "tailwindcss/theme.css";
}

@layer utilities {
	@import "tailwindcss/utilities.css";
}

/* Global box-sizing reset */
*,
*::before,
*::after {
	box-sizing: border-box;
}

.tabular-nums {
	font-variant-numeric: tabular-nums;
}

/* Apply custom font styles using Tailwind's @layer directive */
.radix-themes {
	--default-font-family: Raleway, Helvetica, Arial, sans-serif;
	--font-family-geosans: "GeosansLight", Helvetica, Arial, sans-serif;
	--font-family-nms: "NMS", "GeosansLight", Helvetica, Arial, sans-serif;
	--letter-spacing-wide: 0.2em;
	--font-weight-bold: 700;
	--color-background: var(--gray-a1);
}

.rt-BaseButton {
	--tw-shadow:
		0 1px 3px 0 var(--tw-shadow-color, rgb(0 0 0 / 0.1)),
		0 1px 2px -1px var(--tw-shadow-color, rgb(0 0 0 / 0.1));
	box-shadow:
		var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow),
		var(--tw-ring-shadow), var(--tw-shadow);
}

body.a11y-font .radix-themes {
	--default-font-family: "AtkinsonHyperlegibleNext", Helvetica, Arial, sans-serif;
	--accent-9: #11809c;
}

:root {
	--grid-columns-flex: 10;
	--grid-column-fixed: 24px;

	/* Default (Mobile) Content Padding */
	--app-content-padding-base: 24px;

	--app-safe-pl: max(var(--app-content-padding-base), env(safe-area-inset-left));
	--app-safe-pr: max(var(--app-content-padding-base), env(safe-area-inset-right));

	--grid-padding: 0px;
	/* Fully managed by app-safe vars in grid calculations */

	--grid-gap-min: 2px;
	--grid-gap-max: 8px;

	--grid-cell-min: 22px;
	--grid-cell-max: 64px;

	/* Available width = viewport - left/right padding */
	/* Use max() to adhere to safe areas OR specific grid padding (e.g. 48px on desktop) */
	--grid-container-width: calc(
		100dvw -
			(
				max(var(--grid-padding), var(--app-safe-pl)) +
					max(var(--grid-padding), var(--app-safe-pr))
			)
	);

	/* Gap scales, but clamped */
	--grid-gap: clamp(var(--grid-gap-min), 1dvw, var(--grid-gap-max));

	/* Formula: (container - fixed - gaps) / flex-cols, clamped */
	--grid-cell-size: clamp(
		var(--grid-cell-min),
		calc(
			(
					(100dvw - var(--grid-column-fixed)) -
						((var(--grid-columns-flex)) * var(--grid-gap)) -
						(
							max(var(--grid-padding), var(--app-safe-pl)) +
								max(var(--grid-padding), var(--app-safe-pr))
						)
				) /
				var(--grid-columns-flex)
		),
		var(--grid-cell-max)
	);

	--empty-icon-color: #00befd28;
	--empty-icon-color-supercharged: #c150ff2d;
}

/* Desktop (Large Screen) Override */
@media (width >=1024px) {
	:root {
		--grid-padding: 48px;
	}
}

/* Landscape / Tablet Notch Support */
@media (width >=639px) and (width <=1023px) {
	:root {
		/* Base padding for content */
		--app-content-padding-base: 32px;

		/* Update grid variable to map to safe padding */
		--grid-padding: 0px;
		--grid-cell-max: 72px;
	}
}

body {
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
	text-rendering: optimizeLegibility;
	font-family: var(--default-font-family);
	min-height: 100dvh;
	width: 100dvw;
	overflow-y: auto;

	/* Mobile: use pre-blurred background image for better performance */
	/* Apply to body pseudo-element for best stability on iOS */
	@media (width <=639px) {
		&::before {
			background-image: url("/assets/img/background@mobile-blurred_v7.webp");
			background-position: center top;
			background-repeat: no-repeat;
			background-size: cover;
			content: "";
			height: 100vh;
			left: 0;
			pointer-events: none;
			position: fixed;
			top: 0;
			width: 100vw;
			will-change: auto;
			z-index: -1;
		}
	}
}

@media (max-width: 1023px) {
	body {
		padding-right: calc(100dvw - 100%) !important;
		overflow-x: hidden;
	}

	html {
		overflow-x: hidden;
	}
}

/* Heading styled utility */
.heading-styled {
	font-family: var(--font-family-geosans);
	font-weight: 700;
	letter-spacing: var(--letter-spacing-wide);
	margin-right: calc(var(--letter-spacing-wide) * -1);
	-webkit-text-stroke: 0.1px;
	text-transform: uppercase;
	word-spacing: -0.15em;
}

body.a11y-font .heading-styled {
	font-family: var(--default-font-family);
	font-weight: 600;
	word-spacing: normal;
	letter-spacing: normal;
	-webkit-text-stroke: 0;
	text-transform: uppercase;
}

@media (min-width: 640px) {
	.heading-styled {
		text-shadow: 0 2px 4px var(--accent-a2);
	}
}

/* Dialog close button utility */
.dialog-close {
	position: absolute;
	right: 8px;
	top: 10px;
}

/* Visually hide an element but keep it accessible to screen readers */
.sr-only {
	position: absolute;
	width: 1px;
	height: 1px;
	padding: 0;
	margin: -1px;
	overflow: hidden;
	clip: rect(0, 0, 0, 0);
	white-space: nowrap;
	border-width: 0;
}

/* ============================================ */
/* PERFORMANCE OPTIMIZATIONS                   */
/* ============================================ */

/* Reduce animation overhead when page is hidden */
@media (prefers-reduced-motion: reduce) {
	*,
	*::before,
	*::after {
		animation-duration: 0.01ms !important;
		animation-iteration-count: 1 !important;
		transition-duration: 0.01ms !important;
		scroll-behavior: auto !important;
	}
}

/* Note: scroll-behavior: smooth can cause rendering jank */
/* Let browsers use auto scroll by default */

/* Optimize focus states to prevent reflows */
*:focus {
	outline-offset: 2px;
	/* Prevents outline from triggering repaint of adjacent elements */
}

/* ============================================ */
/* RADIX UI ACCESSIBILITY FIXES                */
/* ============================================ */

/* Fix Radix UI focus guards: elements with aria-hidden should not be tabbable
 * See: https://github.com/radix-ui/primitives/issues/1586 */
[data-radix-focus-guard][aria-hidden="true"] {
	/* Remove from tab order while keeping for programmatic focus management */
	position: fixed !important;
	opacity: 0 !important;
	pointer-events: none !important;
	/* Critically: make it not tabbable */
	display: none !important;
}
