name: Crowdin Sync

on:
    push:
        branches:
            - main
    schedule:
        - cron: "0 0 * * *" # every day at midnight UTC

jobs:
    sync:
        runs-on: ubuntu-latest
        permissions:
            contents: write
            pull-requests: write

        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Crowdin Action
              uses: crowdin/github-action@v4
              with:
                  # Crowdin authentication
                  config: crowdin.yml
                  project_id: ${{ secrets.CROWDIN_PROJECT_ID }}
                  token: ${{ secrets.CROWDIN_PERSONAL_TOKEN }}

                  # GitHub authentication (PAT)
                  github_token: ${{ secrets.GITHUB_TOKEN }}

                  # Sync options
                  upload_sources: true
                  download_translations: true

                  # Pull Request options
                  create_pull_request: true
                  pull_request_title: "New Crowdin Translations Pull"
                  pull_request_body: "This pull request contains the latest translations from Crowdin."
                  pull_request_base_branch_name: "main"
                  localization_branch_name: "crowdin-translations"
                  pull_request_labels: "translation"
